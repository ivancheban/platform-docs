# Секреты

Секреты дают возможность хранить конфиденциальную информацию на платформе - будь то пароли, ключи доступа, токены, и т.д. Вы можете использовать секреты внутри своих заданий для безопасного доступа к различным сторонним сервисам. Секреты платформы работают на основе [Kubernetes secrets](https://kubernetes.io/docs/concepts/configuration/secret/). Вы можете управлять секретами как через Neu.ro CLI, так и через веб-интерфейс платформы.

### Создание секретов

#### Создание секретов в CLI

для создания секретов в Neu.ro CLI используется команда `neuro secret add`:

```text
> neuro secret add secret-password p@$$w0rd123
```

Это создаст секрет с ключом _secret-password_ и значением _p@$$w0rd123_.

Вы также можете указать на существующий файл с желаемым значением при создании секрета, используя нотацию `@`:

```text
> neuro secret add secret-password @путь/к/файлу.txt
```

#### Создание секретов в веб-интерфейсе

Для создания секрета в веб-интерфейсе платформы:

* Войдите в свою учётную запись платформы
* Перейдите во вкладку **Секреты**:

![](../.gitbook/assets/image%20%2882%29.png)

* Нажмите на иконку **Add**:

![](../.gitbook/assets/image%20%2880%29.png)

* Введите ключ и значение секрета и нажмите **Подтвердить**:

![](../.gitbook/assets/image%20%2873%29.png)

Новый секрет будет добавлен в список Ваших секретов:

![](../.gitbook/assets/image%20%2869%29.png)

### Использование секретов

Есть два способа использования секретов в заданиях - как файл и как переменная окружения. Далее описано, как оба этих способа работают в CLI и в веб-интерфейсе платформы.

#### Использование секретов в CLI

Для использования секрета как файла, пропишите его положение в параметре`--volume` при запуске задания. Например:

```text
--volume secret:secret-password:/var/secrets/secret-password.txt
```

Для использования секрета как переменной окружения, объявите переменную в параметре `--env` при запуске задания:

```text
--env mypass:secret:secret-password
```

Теперь, в зависимости от выбранного Вами способа, к секрету можно доступиться по его пути `/var/secrets/secret-password.txt` или считывая значение переменной `mypass`.

#### Использование секретов в веб-интерфейсе платформы

Для использования секрета:

* Войдите в свою учётную запись платформы 
* На Вашей **Панели инструментов**, нажмите **ЗАПУСТИТЬ** в виджете, с которым Вы хотите работать. В этом примере мы используем **Терминал**:

![](../.gitbook/assets/image%20%2878%29.png)

* Нажмите **ДОБАВИТЬ НОВЫЙ СЕКРЕТ** в открывшемся окне:

![](../.gitbook/assets/image%20%2865%29.png)

* Выберите тип секрета, который Вы хотите использовать, и ключ секрета из выпадающего списка. Затем, в зависимости от выбранного типа секрета, введите имя переменной окружения или путь к файлу с секретом:

![](../.gitbook/assets/image%20%2876%29.png)

* Нажмите **ЗАПУСТИТЬ.** Вы сможете использовать выбранный секрет в задании, запущенном таким образом.

### Предоставление доступа к секретам

Предоставлять доступ к Вашим секретам можно с помощью команды  `neuro share` в CLI. Синтаксис выглядит как `neuro share secret:key <username>`. Например:

```text
> neuro share secret:secret-password bob
```

Это даст доступ к серету `secret-password` пользователю Bob.

На данный момент предоставление доступа к секретам работает таким образом, что пользователь Bob не сможет увидеть этот секрет в списке своих секретов, выполняя команду `neuro secret ls`. Чтобы проверить, есть ли у него доступ к этому секрету, пользователь Bob должен будет выполнить команду `neuro acl list` и найти в её выводе URI соответствующего секрета. Например, если этот секрет был изначально создан пользователем Alice, его URI будет выглядеть следующим образом:

```text
secret://neuro-compute/alice/secret-password
```

### Удаление секретов

#### Удаление секретов в CLI

Для удаления секрета используется команда `neuro secret rm`:

```text
> neuro secret rm secret-password
```

Чтобы проверить, что секрет был удалён, выполните команду `neuro secret ls`, которая покажет текущий список Ваших секретов:

```text
> neuro secret ls

  KEY
╶─────────────╴
  aws-key
  gcp-key
  wandb-token
```

#### Удаление секретов в веб-интерфейсе платформы

* Зайдите во вкладку **Секреты**.
* Нажмите на иконку "**мусорное ведро**" справа от секрета, который Вы хотите удалить:

![](../.gitbook/assets/image%20%2864%29.png)

* Нажмите на иконку "**галочка**", чтобы подтвердить изменения:

![](../.gitbook/assets/image%20%2881%29.png)

