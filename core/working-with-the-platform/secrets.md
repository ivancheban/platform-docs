# Секреты

Секреты дают возможность хранить конфиденциальную информацию на платформе - будь то пароли, ключи доступа, токены, и т.д. Вы можете использовать секреты внутри своих заданий для безопасного доступа к различным сторонним сервисам. Секреты платформы работают на основе [Kubernetes secrets](https://kubernetes.io/docs/concepts/configuration/secret/). Вы можете управлять секретами как через CLI, так и через веб-интерфейс платформы.

## Создание секретов

### Создание секретов в CLI

для создания секретов в CLI используется команда `neuro secret add`:

```text
> neuro secret add secret-password p@$$w0rd123
```

Это создаст секрет с ключом _secret-password_ и значением _p@$$w0rd123_.

Вы также можете указать на существующий файл с желаемым значением при создании секрета, используя нотацию `@`:

```text
> neuro secret add secret-password @путь/к/файлу.txt
```

### Создание секретов в веб-интерфейсе

Для создания секрета в веб-интерфейсе платформы:

* Войдите в свою учётную запись платформы
* Перейдите во вкладку **Секреты**
* Нажмите на иконку **Добавить**:

![](../../.gitbook/assets/image%20%2841%29.png)

* Введите ключ и значение секрета и нажмите **Подтвердить**:

![](../../.gitbook/assets/image%20%2822%29.png)

Новый секрет будет добавлен в список ваших секретов:

![](../../.gitbook/assets/image%20%2828%29.png)

## Использование секретов

Есть два способа использования секретов в заданиях - как файл и как переменная окружения. Далее описано, как оба этих способа работают в CLI и в веб-интерфейсе платформы.

### Использование секретов в CLI

Для использования секрета как файла, пропишите его положение в параметре`--volume` при запуске задания. Например:

```text
--volume secret:secret-password:/var/secrets/secret-password.txt
```

Для использования секрета как переменной окружения, объявите переменную в параметре `--env` при запуске задания:

```text
--env mypass=secret:secret-password
```

Теперь, в зависимости от выбранного Вами способа, к секрету можно доступиться по его пути `/var/secrets/secret-password.txt` или считывая значение переменной `mypass`.

### Использование секретов в веб-интерфейсе платформы

Для использования секрета:

* Войдите в свою учётную запись платформы 
* На Вашей **Панели инструментов**, нажмите **ЗАПУСТИТЬ** в виджете, с которым Вы хотите работать. В этом примере мы используем **Терминал**:

![](../../.gitbook/assets/image%20%2835%29.png)

* Нажмите **ДОБАВИТЬ НОВЫЙ СЕКРЕТ** в открывшемся окне:

![](../../.gitbook/assets/image%20%2849%29.png)

* Выберите тип секрета, который вы хотите использовать, и ключ секрета из выпадающего списка. Затем, в зависимости от выбранного типа секрета, введите имя переменной окружения или путь к файлу с секретом:

![](../../.gitbook/assets/image%20%2830%29.png)

* Нажмите **ЗАПУСТИТЬ.** Вы сможете использовать выбранный секрет в задании, запущенном таким образом.

## Предоставление доступа к секретам

Предоставлять доступ к Вашим секретам можно с помощью команды `neuro acl grant` в CLI. Синтаксис выглядит как `neuro acl grant secret:<key> <username> <access-level>`. Например:

```text
> neuro acl grant secret:secret-password bob read
```

Это даст доступ к секрету `secret-password` пользователю Bob.

Вы также можете использовать упрощнную версию этой команды - `neuro share`:

```text
> neuro share secret:secret-password bob
```

На данный момент предоставление доступа к секретам работает таким образом, что пользователь Bob не сможет увидеть этот секрет в списке своих секретов, выполняя команду `neuro secret ls`. Чтобы проверить, есть ли у него доступ к этому секрету, пользователь Bob должен будет выполнить команду `neuro acl list` и найти в её выводе URI соответствующего секрета. Например, если этот секрет был изначально создан пользователем Alice, его URI будет выглядеть следующим образом:

```text
secret://neuro-compute/alice/secret-password
```

## Удаление секретов

### Удаление секретов в CLI

Для удаления секрета используется команда `neuro secret rm`:

```text
> neuro secret rm secret-password
```

Чтобы проверить, что секрет был удалён, выполните команду `neuro secret ls`, которая покажет текущий список Ваших секретов:

```text
> neuro secret ls

  KEY
╶─────────────╴
  aws-key
  gcp-key
  wandb-token
```

### Удаление секретов в веб-интерфейсе платформы

* Зайдите во вкладку **Секреты**.
* Нажмите на иконку **Удалить** справа от секрета, который Вы хотите удалить:

![](../../.gitbook/assets/image%20%2812%29.png)

* Нажмите **Подтвердить**:

![](../../.gitbook/assets/image%20%2844%29.png)

