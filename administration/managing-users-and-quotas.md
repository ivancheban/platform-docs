# Управление пользователями и квотами

Платформа создаёт кластер на основе файла конфигурации кластера, который Вы отослали нашей команде. Пользователь, создавший кластер, назначается его администратором. Перед тем, как начать использовать узлы в кластере, Вам нужно добавить пользователей и, по желанию, квоты. Команда  `neuro admin get-clusters` показывает список кластеров, которыми вы можете управлять.

```text
> neuro admin get-clusters
company-cluster                                                                                      
 Status      Deployed                                                                              
 Cloud       azure                                                                                 
 Region      eastus                                                                                
 Zones       2                                                                                     
 Node pools                                                                                        
               Machine            CPU   Memory   Preemptible                     GPU   Min   Max   
              ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  
               Standard_D8_v3     7.0    28.0G        ×                                  1    10   
               Standard_NC6       5.0    50.0G        ×         1 x nvidia-tesla-k80     0    30   
               Standard_NC6       5.0    50.0G        √         1 x nvidia-tesla-k80     0    30   
               Standard_NC6s_v3   5.0   106.0G        ×        1 x nvidia-tesla-v100     0    10   
               Standard_NC6s_v3   5.0   106.0G        √        1 x nvidia-tesla-v100     0    10   
                                                                                                   
 Storage     Premium tier Azure Files with LRS replication type and 3072 GiB file share size       

```

В свою очередь, команда `neuro config get-clusters` показывает список кластеров, к которым у вас есть доступ.

Вы можете управлять аккаунтами пользователей и их квотами с помощью CLI. The next sections discuss how you can manage users and user quotas.

### Какие роли пользователей существуют?

Платформа предоставлет три стандартных роли пользователей - `user`, `manager`, `admin`. По умолчанию используется роль `user`. Нижеприведенная таблица содержит подробную информацию о функциональности разных ролей. Помните, что каждый зарегистрированный на платформе пользователь может создавать кластеры; при создании кластера, создавший его пользователь получает роль `admin`.

<table>
  <thead>
    <tr>
      <th style="text-align:left"><b>&#x420;&#x43E;&#x43B;&#x44C;</b>
      </th>
      <th style="text-align:left"><b>&#x41E;&#x43F;&#x438;&#x441;&#x430;&#x43D;&#x438;&#x435;</b>
      </th>
      <th style="text-align:left"><b>&#x41F;&#x440;&#x430;&#x432;&#x430;</b>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">User</td>
      <td style="text-align:left">&#x41E;&#x431;&#x44B;&#x447;&#x43D;&#x44B;&#x439; &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x44C;
        &#x43F;&#x43B;&#x430;&#x442;&#x444;&#x43E;&#x440;&#x43C;&#x44B; &#x431;&#x435;&#x437;
        &#x43E;&#x441;&#x43E;&#x431;&#x44B;&#x445; &#x434;&#x43E;&#x43F;&#x43E;&#x43B;&#x43D;&#x438;&#x442;&#x435;&#x43B;&#x44C;&#x43D;&#x44B;&#x445;
        &#x43F;&#x440;&#x430;&#x432;. &#x422;&#x430;&#x43A;&#x438;&#x435; &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x438;
        &#x43C;&#x43E;&#x433;&#x443; &#x443;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x44F;&#x442;&#x44C;
        &#x437;&#x430;&#x434;&#x430;&#x43D;&#x438;&#x44F;&#x43C;&#x438;, &#x434;&#x438;&#x441;&#x43A;&#x43E;&#x432;&#x44B;&#x43C;
        &#x43F;&#x440;&#x43E;&#x441;&#x442;&#x440;&#x430;&#x43D;&#x441;&#x442;&#x43E;&#x43C;
        &#x438; &#x43E;&#x431;&#x440;&#x430;&#x437;&#x430;&#x43C;&#x438; - &#x43A;&#x430;&#x43A;
        &#x441;&#x432;&#x43E;&#x438;&#x43C;&#x438;, &#x442;&#x430;&#x43A; &#x438;
        &#x442;&#x435;&#x43C;&#x438;, &#x43A; &#x43A;&#x43E;&#x442;&#x43E;&#x440;&#x44B;&#x43C;
        &#x438;&#x43C; &#x43E;&#x442;&#x43A;&#x440;&#x44B;&#x43B;&#x438; &#x434;&#x43E;&#x441;&#x442;&#x443;&#x43F;.</td>
      <td
      style="text-align:left">
        <ul>
          <li>&#x423;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435;
            &#x437;&#x430;&#x434;&#x430;&#x43D;&#x438;&#x44F;&#x43C;&#x438;, &#x43A;
            &#x43A;&#x43E;&#x442;&#x43E;&#x440;&#x44B;&#x43C; &#x435;&#x441;&#x442;&#x44C;
            &#x434;&#x43E;&#x441;&#x442;&#x443;&#x43F;</li>
          <li>&#x423;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435;
            &#x434;&#x438;&#x441;&#x43A;&#x43E;&#x432;&#x44B;&#x43C; &#x43F;&#x440;&#x43E;&#x441;&#x442;&#x440;&#x430;&#x43D;&#x441;&#x442;&#x432;&#x43E;&#x43C;,
            &#x43A; &#x43A;&#x43E;&#x442;&#x43E;&#x440;&#x43E;&#x43C;&#x443; &#x435;&#x441;&#x442;&#x44C;
            &#x434;&#x43E;&#x441;&#x442;&#x443;&#x43F;</li>
          <li>&#x423;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435;
            &#x43E;&#x431;&#x440;&#x430;&#x437;&#x430;&#x43C;&#x438;, &#x43A; &#x43A;&#x43E;&#x442;&#x43E;&#x440;&#x44B;&#x43C;
            &#x435;&#x441;&#x442;&#x44C; &#x434;&#x43E;&#x441;&#x442;&#x443;&#x43F;</li>
        </ul>
        </td>
    </tr>
    <tr>
      <td style="text-align:left">Manager</td>
      <td style="text-align:left">&#x41F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x438;,
        &#x43A;&#x43E;&#x442;&#x43E;&#x440;&#x44B;&#x435; &#x43C;&#x43E;&#x433;&#x443;&#x442;
        &#x443;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x44F;&#x442;&#x44C; &#x432;&#x441;&#x435;&#x43C;&#x438;
        &#x437;&#x430;&#x434;&#x430;&#x43D;&#x438;&#x44F;&#x43C;&#x438;, &#x434;&#x438;&#x441;&#x43A;&#x43E;&#x432;&#x44B;&#x43C;
        &#x43F;&#x440;&#x43E;&#x441;&#x442;&#x440;&#x430;&#x43D;&#x441;&#x442;&#x432;&#x43E;&#x43C;,
        &#x438; &#x43E;&#x431;&#x440;&#x430;&#x437;&#x430;&#x43C;&#x438; &#x43D;&#x430;
        &#x43A;&#x43B;&#x430;&#x441;&#x442;&#x435;&#x440;&#x435;, &#x430; &#x442;&#x430;&#x43A;&#x436;&#x435;
        &#x430;&#x43A;&#x43A;&#x430;&#x443;&#x43D;&#x442;&#x430;&#x43C;&#x438;
        &#x434;&#x440;&#x443;&#x433;&#x438;&#x445; &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x435;&#x439;.</td>
      <td
      style="text-align:left">
        <ul>
          <li>&#x423;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435;
            &#x432;&#x441;&#x435;&#x43C;&#x438; &#x437;&#x430;&#x434;&#x430;&#x43D;&#x438;&#x44F;&#x43C;&#x438;
            &#x43A;&#x43B;&#x430;&#x441;&#x442;&#x435;&#x440;&#x430;</li>
          <li>&#x423;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435;
            &#x432;&#x441;&#x435;&#x43C; &#x434;&#x438;&#x441;&#x43A;&#x43E;&#x432;&#x44B;&#x43C;
            &#x43F;&#x440;&#x43E;&#x441;&#x442;&#x440;&#x430;&#x43D;&#x441;&#x442;&#x432;&#x43E;&#x43C;
            &#x43A;&#x43B;&#x430;&#x441;&#x442;&#x435;&#x440;&#x430;</li>
          <li>&#x423;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435;
            &#x432;&#x441;&#x435;&#x43C;&#x438; &#x43E;&#x431;&#x440;&#x430;&#x437;&#x430;&#x43C;&#x438;
            &#x43A;&#x43B;&#x430;&#x441;&#x442;&#x435;&#x440;&#x430;</li>
          <li>&#x423;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435;
            &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x44F;&#x43C;&#x438;</li>
        </ul>
        </td>
    </tr>
    <tr>
      <td style="text-align:left">Admin</td>
      <td style="text-align:left">&#x410;&#x43D;&#x430;&#x43B;&#x43E;&#x433;&#x438;&#x447;&#x43D;&#x43E;
        &#x440;&#x43E;&#x43B;&#x438; <code>manager</code>, &#x441; &#x434;&#x43E;&#x43F;&#x43E;&#x43B;&#x43D;&#x438;&#x442;&#x435;&#x43B;&#x44C;&#x43D;&#x43E;&#x439;
        &#x432;&#x43E;&#x437;&#x43C;&#x43E;&#x436;&#x43D;&#x43E;&#x441;&#x442;&#x44C;&#x44E;
        &#x43C;&#x435;&#x43D;&#x44F;&#x442;&#x44C; &#x43A;&#x43E;&#x43D;&#x444;&#x438;&#x433;&#x443;&#x440;&#x430;&#x446;&#x438;&#x44E;
        &#x43A;&#x43B;&#x430;&#x441;&#x442;&#x435;&#x440;&#x43E;&#x432; &#x438;
        &#x443;&#x434;&#x430;&#x43B;&#x44F;&#x442;&#x44C; &#x438;&#x445;. &#x422;&#x430;&#x43A;&#x438;&#x435;
        &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x438;
        &#x442;&#x430;&#x43A;&#x436;&#x435; &#x43C;&#x43E;&#x433;&#x443;&#x442;
        &#x434;&#x43E;&#x431;&#x430;&#x432;&#x43B;&#x44F;&#x442;&#x44C; &#x43F;&#x443;&#x43B;&#x44B;
        &#x443;&#x437;&#x43B;&#x43E;&#x432;.</td>
      <td style="text-align:left">
        <ul>
          <li>&#x423;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435;
            &#x432;&#x441;&#x435;&#x43C;&#x438; &#x437;&#x430;&#x434;&#x430;&#x43D;&#x438;&#x44F;&#x43C;&#x438;
            &#x43A;&#x43B;&#x430;&#x441;&#x442;&#x435;&#x440;&#x430;</li>
          <li>&#x423;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435;
            &#x432;&#x441;&#x435;&#x43C; &#x434;&#x438;&#x441;&#x43A;&#x43E;&#x432;&#x44B;&#x43C;
            &#x43F;&#x440;&#x43E;&#x441;&#x442;&#x440;&#x430;&#x43D;&#x441;&#x442;&#x432;&#x43E;&#x43C;
            &#x43A;&#x43B;&#x430;&#x441;&#x442;&#x435;&#x440;&#x430;</li>
          <li>&#x423;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435;
            &#x432;&#x441;&#x435;&#x43C;&#x438; &#x43E;&#x431;&#x440;&#x430;&#x437;&#x430;&#x43C;&#x438;
            &#x43A;&#x43B;&#x430;&#x441;&#x442;&#x435;&#x440;&#x430;</li>
          <li>&#x423;&#x43F;&#x440;&#x430;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435;
            &#x43F;&#x43E;&#x43B;&#x44C;&#x437;&#x43E;&#x432;&#x430;&#x442;&#x435;&#x43B;&#x44F;&#x43C;&#x438;</li>
          <li>&#x423;&#x434;&#x430;&#x43B;&#x435;&#x43D;&#x438;&#x435; &#x43A;&#x43B;&#x430;&#x441;&#x442;&#x435;&#x440;&#x43E;&#x432;</li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

### Как добавить пользователя на кластер?

Вы може те добавить любое количество пользователей на кластер. Перед добавлением пользователя, Вам нужно понять, какую роль и квоту вы хотите предоставить этому пользователю.

Роль определяет права доступа пользователя на платформе. Квота определяет количество часов GPU и CPU, доступные пользователю.

```text
> neuro admin add-cluster-user neuro-public john user
Added john to cluster default as user
```

### Как удалить пользователя с кластера?

Вы можете удалить пользователя с кластера, если ваша роль - `admin` или `manager`. Для удаления пользователей используется команда `neuro admin remove-cluster-user`. Запуск этой команды отменяет права доступа пользователя к кластеру. Все сущности, принадлежащие этому пользователю, остаются в целости \(дисковое пространство, задания, образы, и т.д.\), и удалённого пользователя можно будет добавить на кластер заново.

```text
> neuro admin remove-cluster-user default john
Removed john from cluster default
```

### Как изменить роль пользователя?

Для изменения роли пользователя, Вам потребуетсяя удалить его с кластера и добавить заново с новой ролью. Как указывалось выше, все сущности, принадлежащие пользователю, при этом процессе не затрагиваются.

### Как управлять квотой пользователя?

Квота определяет количество часов GPU и CPU, доступные пользователю. По умолчанию пользователю доступно 100 часов GPU и неограниченное количество часов CPU.

Вы можете изменить квоту пользователя, используя одну из следующих команд:

* `neuro admin set-user-quota`: Эта команда устанавливает квоту в определённое количество часов. Вам требуется указать желаемое количество часов - например, 3.5h, 20h, 50h, и т.д.

```text
> neuro admin set-user-quota -g 50h default john
New quotas for john on cluster default:
GPU: 3000m
CPU: infinity
```

* `neuro admin add-user-quota`: Эта команда добавляет указанное количество часов к текущему значению квоты пользователя.

```text
> neuro admin add-user-quota -g 50h default john
New quotas for john on cluster default:
GPU: 6000m
CPU: infinity
```

Квоту также можно указывать в минутах. Например, для установки квоты в 30 минут, используйте `30m`:

```text
> neuro admin set-user-quota -g 30m default john
New quotas for john on cluster default:
GPU: 30m
CPU: infinity
```

Вы также можете установить неограниченную квоту для пользователя:

```text
> neuro admin set-user-quota default john
New quotas for john on cluster default:
GPU: infinity
CPU: infinity
```

Вы можете проверить квоту любого пользователя на кластере, если ваша роль на этом кластере - `manager` или `admin`.

```text
> neuro config show-quota john
GPU: spent: 91h 37m (quota: 200h 00m, left: 108h 23m)
CPU: spent: 1036h 00m (quota: infinity)
```

