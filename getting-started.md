# Начало работы

В данном руководстве мы покажем Вам, как начать работу с Neu.ro:

* Установка клиента CLI;
* Основные понятия; и
* Начало работы на GPU в среде Jupyter Notebooks.

## Установка CLI

Для начала работы с CLI имеются две возможности:

* При помощи [Веб терминала](https://apps.neu.ro/shell?cluster_name=neuro-public)
* Установив Neu.ro CLI на Ваш компьютер и выполнив команду `neuro login`

Первый вариант рекомендуется для изучения платформы. Второй вариант лучше подходит для работы над Вашими проектами.

### Установка в Linux и Mac OS

Neu.ro CLI требует установленный Python 3 \(рекомендуется: 3.7, требуется: &gt;=3.6\). Мы советуем использовать [Anaconda Python 3.7 Distribution](https://www.anaconda.com/distribution/).

```text
pip install -U neuromation
neuro login
```

### Установка в Windows

Несмотря на то, что есть несколько вариантов запустить Neu.ro CLI в Windows, мы настоятельно рекомендуем использовать [Anaconda Python 3.7 Distribution](https://www.anaconda.com/distribution/) с настройками по умолчанию.

После установки Anaconda Python 3.7 Distribution выполните следующие команды в Conda Prompt:

```text
conda install -c conda-forge make
conda install -c conda-forge git    
pip install -U neuromation
pip install -U certifi
neuro login
```

## Основные концепции

На уровне **Neu.ro Core**, происходит работа с заданиями, рабочим окружением и системой хранения \(дисковым пространством\). Проще говоря, возможно запустить задание \(исполнительный блок\) в заданном рабочем окружении \(Docker контейнер\), с заданными характеристиками \(комбинация ресурсов CPU, GPU и памяти\) и с несколькими подключенными блоками для хранения данных \(блоки или объекты хранения\).

Продемонстрируем это на нескольких примерах.

Запустим на CPU задание, которое выводит “Hello, World!” и останавливается:

```text
neuro run --preset cpu-small --name test ubuntu echo Hello, World!
```

После запуска данной команды в терминале Вы увидите следующее:

```text
Job ID: job-2b743322-f53a-4211-be4e-5d493e6cc770 Status: pending
Name: test
Http URL: https://test--johndoe.jobs.neuro-ai-public.org.neu.ro
Shortcuts:
  neuro status test     # check job status
  neuro logs test       # monitor job stdout
  neuro top test        # display real-time job telemetry
  neuro exec test bash  # execute bash shell to the job
  neuro kill test       # kill job
Status: pending Creating
Status: pending Scheduling
StatStatus: pending ContainerCreating
Status: succeeded
Terminal is attached to the remote job, so you receive the job's output.
Use 'Ctrl-C' to detach (it will NOT terminate the job), or restart the
job with `--detach` option.                
Hello, World!
```

Запустим задание на GPU в рабочем окружении Neu.ro по умолчанию \(`neuromation/base`\), которое показывает, доступно ли CUDA в данном рабочем окружении:

```text
neuro run --preset gpu-small --name test neuromation/base python -c "import torch; print(torch.cuda.is_available());"
```

Проверим настройки, которые Вы можете использовать:

```text
neuro config show
```

Создадим каталог `demo` в корне дискового пространства Вашей платформы:

```text
neuro mkdir -p storage:demo
```

Запустим команду, которая монтирует каталог `demo` на диске к `/demo` в контейнере и создает в нем файл:

```text
neuro run --preset cpu-small --name test --volume storage:demo:/demo:rw ubuntu "echo Hello >> /demo/hello.txt"
```

Убедитесь, что файл находится на диске:

```text
neuro ls storage:demo
```

## Разработка на GPU

Хотя сеанс Jupyter Notebooks можно запустить с помощью одной команды в командной строке или одним щелчком мыши в веб-интерфейсе, мы рекомендуем вести разработку на основе проектов. Чтобы упростить процесс мы предоставляем шаблон проекта, который является частью **Neu.ro Toolbox** и предоставляет структуру папок и интеграцию с несколькими рекомендуемыми инструментами.

### Создание проекта

Чтобы создать новый проект из шаблона выполните команду:

```text
neuro project init
```

Данная команда задает несколько вопросов относительно Вашего проекта:

```text
project_name [Name of the project]: Neuro Tutorial
project_slug [neuro-tutorial]:
code_directory [modules]:
```

Вы можете нажать Enter, если вы согласны с предложенным выбором.

Чтобы перейти к каталогу проекта, введите команду:

```text
cd neuro-tutorial
```

### Структура проекта

После ввода указанной выше команды Вы можете увидеть следующую структуру:

```text
neuro-tutorial
├── config/             <- configuration files for various integrations
├── data/               <- training and testing datasets (we do not keep it under source control)
├── notebooks/          <- Jupyter notebooks
├── modules/            <- source code of models
├── results/            <- training artifacts
├── .gitignore          <- default .gitignore for a Python ML project
├── HELP.md             <- autogenerated template reference
├── Makefile            <- various ML development tasks (see `make help`)
├── README.md           <- autogenerated informational file
├── apt.txt             <- list of system packages to be installed in the training environment
├── requirements.txt    <- list of Python dependencies to be installed in the training environment
└── setup.cfg           <- linter settings (Python code quality checking)
```

Шаблон содержит Makefile, который обеспечивает связь между указанной выше структурой файлов и каталогов, базовым рабочим окружением, которое мы предоставляем и манипуляциями с дисковым пространством и заданиями. Например, с помощью команд `upload-*` and `download-*` подпапки на Вашем локальном компьютере синхронизируются с подпапками на дисковом пространстве платформы, соответственно подпапки на дисковом пространстве синхронизируются с соответствующими подпапками в контейнерах заданий.

### Настройка рабочей среды и запуск Jupyter

Чтобы настроить рабочее окружение, выполните:

```text
make setup
```

После выполнения данной команды в базовую среду, которая уже содержит поддержку CUDA и наиболее популярные пакеты ML/AL, такие как Tensorflow и Pytorch, будут установлены системные пакеты из `apt.txt` и pip зависимости из файла `requirements.txt`.

Чтобы запустить Jupyter Notebooks на GPU, выполните команду:

```text
make jupyter
```

Данная команда открывает интерфейс Jupyter Notebooks в вашем браузере, который указан по умолчанию.

Теперь, когда Вы пишите программу в Jupyter Notebooks она сохраняется на дисковом пространстве платформы. Чтобы скачать ее на Ваш компьютер \(например, чтобы поставить под контроль системы контроля версий\), введите команду:

```text
make download-notebooks
```

Не забудьте закончить работу задания, когда оно Вам больше не нужно \(файлы после этого не пропадут\):

```text
make kill-jupyter
```

Чтобы проверить, сколько часов GPU и CPU у вас осталось, запустите команду:

```text
neuro config show-quota
```

